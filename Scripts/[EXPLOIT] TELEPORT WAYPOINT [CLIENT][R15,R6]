wait("Teleport waypoint by Nineteen_DEV")

local Player = game.Players.LocalPlayer

local SpawnWaypointButton
local TeleportWaypointButton
local CancelButton

local CurrectWaypoint
local Position
local BeamGlobal

function Character() : Model
	return Player.Character or Player.CharacterAdded:Wait()
end

function Humanoid() : Humanoid
	return Character():FindFirstChildWhichIsA("Humanoid")
end

function Cancel()
	
	TeleportWaypointButton.Visible = false
	CancelButton.Visible = false
	
	if CurrectWaypoint ~= nil then

		CurrectWaypoint:Destroy()

	end

	if BeamGlobal ~= nil then

		BeamGlobal:Destroy()

	end
	
end

function Teleport()
	
	TeleportWaypointButton.Visible = false
	CancelButton.Visible = false
	
	local Humanoid = CurrectWaypoint:FindFirstChildWhichIsA("Humanoid")
	
	local Char = Character()
	
	Char:MoveTo(Position)
	
	if CurrectWaypoint ~= nil then

		CurrectWaypoint:Destroy()

	end
	
	if BeamGlobal ~= nil then
		
		BeamGlobal:Destroy()
		
	end
	
end

function MakeWaypoint()
	
	TeleportWaypointButton.Visible = true
	CancelButton.Visible = true
	
	if CurrectWaypoint ~= nil then
		
		CurrectWaypoint:Destroy()
		
	end
	
	CurrectWaypoint = Instance.new("Model")
	local Char = Character()
	
	for Order, base : Instance in Char:GetChildren() do
		
		local clone = base:Clone()			
		clone.Parent = CurrectWaypoint
		
	end
	
	for order, clone : Instance in CurrectWaypoint:GetDescendants() do

		if clone:IsA("BasePart") then
			
			clone.Anchored = true
			clone.CanQuery = false
			clone.CanTouch = false
			clone.Transparency = .7
			clone.CanCollide = false

		end

	end
	
	local HumanoidWaypoint = CurrectWaypoint:FindFirstChildWhichIsA("Humanoid")
	local RootPartWaypoint = HumanoidWaypoint.RootPart
	
	local Huma = Humanoid()

	RootPartWaypoint.CFrame = Huma.RootPart.CFrame
	
	CurrectWaypoint.Name = Player.Name.." Waypoint"
	
	CurrectWaypoint.Parent = workspace
	
	local Beam = Instance.new("Beam")
	
	local Attachment0 = Instance.new("Attachment")
	local Attachment1 = Instance.new("Attachment")
	
	Attachment0.Parent = HumanoidWaypoint.RootPart
	Attachment1.Parent = Huma.RootPart
	
	Beam.Attachment0 = Attachment0
	Beam.Attachment1 = Attachment1
	
	Beam.Parent = Huma.RootPart
	
	BeamGlobal = Beam
	
	task.wait()
	
	Position = RootPartWaypoint.Position
	
	for order, clone : Instance in CurrectWaypoint:GetDescendants() do

		if clone:IsA("BasePart") then

			clone.Anchored = true
			clone.CanQuery = false
			clone.CanTouch = false
			clone.Transparency = .7
			clone.CanCollide = false

		end

	end
	
	Char:MoveTo(Huma.RootPart.Position)
	
end

function CreateGui()

	local ScreenGui = Instance.new("ScreenGui")
	ScreenGui.Name = "WaypointTeleport"
	ScreenGui.ResetOnSpawn = false

	local Button = Instance.new("TextButton")
	Button.Text = "Create Waypoint"
	Button.TextScaled = true
	Button.Size = UDim2.new(.08,0,.1,0)
	Button.Position = UDim2.new(.05,0,.25,0)
	Button.BackgroundColor = BrickColor.Blue()
	Button.Parent = ScreenGui
	
	local Button2 = Instance.new("TextButton")
	Button2.Text = "Teleport"
	Button2.TextScaled = true
	Button2.Visible = false
	Button2.Size = UDim2.new(.04,0,.1,0)
	Button2.Position = UDim2.new(.15,0,.25,0)
	Button2.BackgroundColor = BrickColor.Green()
	Button2.Parent = ScreenGui
	
	local Button3 = Instance.new("TextButton")
	Button3.Text = "Cancel"
	Button3.TextScaled = true
	Button3.Visible = false
	Button3.Size = UDim2.new(.04,0,.1,0)
	Button3.Position = UDim2.new(.2,0,.25,0)
	Button3.BackgroundColor = BrickColor.Red()
	Button3.Parent = ScreenGui
	
	CancelButton = Button3
	SpawnWaypointButton = Button
	TeleportWaypointButton = Button2

	ScreenGui.Parent = Player.PlayerGui

	task.wait()

end

CreateGui()

SpawnWaypointButton.Activated:Connect(MakeWaypoint)
TeleportWaypointButton.Activated:Connect(Teleport)
CancelButton.Activated:Connect(Cancel)
